<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BroadView&trade; API Guide and Reference Manual: API</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BroadView&trade; API Guide and Reference Manual
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Welcome</span></a></li>
      <li class="current"><a href="../../pages.html"><span>BroadViewâ„¢&#160;Documentation</span></a></li>
      <li><a href="../../modules.html"><span>API&#160;Reference</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dc/d5f/REST_PT.html">PT REST API</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="PT_MSG"></a>
JSON-RPC Messaging</h1>
<p>The API is REST-based and communicated using JSON-RPC messaging. There are three forms of JSON-RPC messages that are supported by the Agent.</p>
<p><b>Request</b> (From Requestor, Received/Processed by Agent), sometimes also called as a Command.<br/>
 <b>Response</b> (From Agent, Received/Processed by Requestor, in response to a previous request)<br/>
 <b>Notification</b> (From Agent, Received/Processed by Requestor, asynchronously)<br/>
 An example JSON-RPC request message sample is provided below for illustrative purposes.<br/>
</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": "configure-packet-trace-feature",
    "asic-id": "1",
    "params": {
        "packet-trace-enable": 1
     },
    "id": 1232
}
A sample JSON-RPC response message is provided below for illustrative purposes.
{
    "jsonrpc": "2.0",
    "asic-id": "1",
    "version": "1",    
    "result": {
        "packet-trace-enable": 1
        }
    },
    "id": 1232
}</pre><pre></pre><p>A notification message is similar to a response message, with the exception that it won't have any "id" field. More details are available at <a href="http://www.jsonrpc.org/specification">http://www.jsonrpc.org/specification</a>. When an agent receives a request from the requestor, the method field specifies the request that is sent. Any data associated with the request is part of the params field.</p>
<h1><a class="anchor" id="PT_BACKGROUND"></a>
Quick Packet Trace Backgrounder</h1>
<p>When a packet enters a system, it is processed and forwarded out on one or more destination ports. Typically the results of intermediate packet processing steps are not visible. If the packet is dropped or not forwarded as expected, drop reason may be set or error event counters maybe incremented. However, since these are typically coarse counters, they may not provide sufficient information to debug why the packet was dropped or forwarded incorrectly. Packet Trace feature provides an device-internal packet tracing mechanism which can help to detect exact reason why packet is getting dropped and finer details like egress hashing information in case of LAG and ECMP etc. Packet Trace feature provides detailed information on how a specific packet is processed through the ingress pipeline. The feature allows the user to inject packet into the Ingress Packet Processing Pipeline that is then processed as if it was received on one of the front panel ports and log internal forwarding and packet processing states. If the packet is dropped, this feature can provide detailed explanation of the packet drop reason. This can be useful in the diagnoses of unexpected errors or as an offline debug tool.</p>
<h1><a class="anchor" id="PT_CONFIGURABILITY"></a>
Configurability</h1>
<p>The following configurability is provided by the Packet Trace feature to the requestor.<br/>
 The Packet Trace feature can be enabled / disabled on the agent.<br/>
 The Packet Trace feature can be configured to collect trace-profile periodically and send trace-profile to the requestor at configurable interval (as notification messages).<br/>
 The Packet Trace feature can provide trace-profile on demand.<br/>
 The Packet Trace feature can be configured to collect drop counters, for each interested drop reason, periodically and send the report to the collector at configurable interval (as notification messages).<br/>
 The Packet Trace feature can provide drop counters report on demand.<br/>
 The Packet Trace feature can be configured to send a copy of dropped packets to collector, for each interested drop reason.<br/>
 The Packet Trace feature can be configured to send dropped packets to requestor after the number of dropped packets cross a configurable threshold.<br/>
 The Packet Trace feature can be configured to send finite number of dropped packets to requestor.<br/>
 The Packet Trace feature can be configured to drop or forward the packet injected by requestor after the trace-profile is collected by the Agent.<br/>
</p>
<h1><a class="anchor" id="PT_ASIC"></a>
Multi ASIC Platforms</h1>
<p>The agent supports platforms with more than one ASIC device. The configuration command / reporting is on per ASIC basis. The configuration commands and the status reports carry the ASIC identifier as part of the message. For a single ASIC platform, the ASIC identifier part of the configuration command is ignored by the Agent, and the corresponding value is set to 0, for status reports.</p>
<h1><a class="anchor" id="PT_TIMESTAMP"></a>
Time stamps</h1>
<p>All of the trace-profile reports and drop-counter reports are time stamped. The time is obtained from the local clock running on the Switch. It may be possible that the clock is 1588 synchronized, but it is beyond the scope of this document. The reports sent by the Agent contain the time stamp which indicates the time at which the data is read from the ASIC. The data is reported in the YYYY-MM-DD - HH:MM:SS format.</p>
<p>A sample JSON report snippet containing a timestamp is provided below.</p>
<pre></pre><pre>...
    "method": "get-packet-trace-profile",
    "asic-id": 2,
    "time-stamp": "2014-10-18 - 00:15:04 ",
    "report": [{
     ...</pre><pre></pre><h1><a class="anchor" id="PT_VERSION"></a>
Version</h1>
<p>The response message from the agent contains version number. The collector may use the version number information to match the response from the agent. There is single version for all responses from the agent. The current version is 1.</p>
<h1><a class="anchor" id="PT_PKTFORMAT"></a>
Packet Format</h1>
<p>Broadview agent expects the packet to be in PCAP format. The PCAP is in binary format but JSON has no data type to represent the binary data. So collector/requestor has to encode the PCAP in base 64. Agent will decode the PCAP information which is in base 64 format to binary and strip the PCAP Global Header and PCAP Packet Header before injecting the packet. Each PCAP file can have multiple packets but BroadView&trade; Agent support only one packet for PCAP file. After decoding, BroadView&trade; agent checks the first 4 bytes for the magic number in PCAP header. If the first 4 bytes is not magic number, the input file data is ignored. Also Broadview Agent checks for major and minor number in PCAP header. The supported major number is 2 and supported minor number is 4. If the magic number and major and minor numbers are valid, then Broadview agent extracts the packet by removing the PCAP file header and the PCAP packet header.</p>
<p>Below is the example of the decoded packet on the Broadview Agent.</p>
<pre></pre><pre>Example decoded packet:</pre><pre>a1 b2 c3 d4 0 2 0 4 0 0 0 0 0 0 0 0
0 0 ff ff 0 0 0 1 55 18 f3 f4 0 b 94 ea
0 0 0 78 0 0 0 78 11 22 33 44 55 66 77 88
99 aa bb cc 81 0 0 1 8 0 45 2 0 66 7f af
d3 a0 40 6 40 59 1 2 3 4 5 6 7 8 10 1
d2 24 10 2 2a 4 50 0 16 d0 5f eb d3 d0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 c 8a 6c f0</pre><pre></pre><p>In the above packet , first 4 bytes are magic number (a1 b2 c3 d4).<br/>
 Major version is 2 (0 2),which is 2 bytes. <br/>
 Minor version number (0 4) is 2 bytes.<br/>
 The total length of the PCAP File header is 24 bytes and the PCAP packet length is 16 bytes.<br/>
 The 4 bytes from offset 32 indicate the captured packet length (00 00 00 78) and the subsequent 4 bytes( 00 00 00 78) indicate the length of the packet on wire. In the input to the Broadview agent, if the length of the captured packet length is smaller than the packet length on wire, then the input is discarded and appropriate error code is returned by Broadview agent.<br/>
</p>
<h1><a class="anchor" id="PT_TP"></a>
Reporting Trace Profile</h1>
<p>The ASIC reports results of packet trace (trace profile) for different switching and routing tables. The results are presented under various categories, called realms.</p>
<div class="image">
<img src="../../pt_traceprofile.jpg" alt="pt_traceprofile.jpg"/>
</div>
 <pre></pre><pre>A sample Trace-profile</pre><pre>{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-profile",
    "asic-id": "1",
    "version": "1",
    "time-stamp": "2014-11-18 - 00:15:04 ",
    "report": [
        {
            "port": "1",
            "trace-profile": [
                {
                    "realm": "lag-link-resolution",
                    "data": {
                        "lag-id": "2",
                        "lag-members": ["1", "2", "3", "4"],
                        "dst-lag-member": "4"
                    }
                },
                {
                    "realm": "ecmp-link-resolution",
                    "data": [
                        {
                            "ecmp-group-id": "200256",
                            "ecmp-members": [["100004", "2.2.2.2", "28"],["100005", "6.6.6.1", "41"]],
                            "ecmp-dst-member": "100005",
                            "ecmp-dst-port": "41",
                            "ecmp-next-hop-ip": "6.6.6.2"
                        },
                        {
                            "ecmp-group-id": "200100",
                            "ecmp-members": [["100001", "3.3.3.1", "31"], ["100002", "7.7.7.2", "21"]],
                            "ecmp-dst-member": "100001",
                            "ecmp-dst-port": "31",
                            "ecmp-next-hop-ip": "3.3.3.2"
                        }
                    ]
                                    }
            ]
        },
        {
            "port": "2",
            "trace-proifle": [
                {
                    "realm": "lag-link-resolution",
                    "data": {
                        "lag-id": "2",
                        "lag-members": ["1","2","3","4"],
                        "dst-lag-member": "4"
                    }
                },
                {
                    "realm": "ecmp-link-resolution",
                    "data": [
                        {
                            "ecmp-group-id": "200256",
                            "ecmp-members": [["100004", "2.2.2.2", "28"],["100005", "6.6.6.1", "41"]],
                            "ecmp-dst-member": "100005",
                            "ecmp-dst-port": "41",
                            "ecmp-next-hop-ip": "6.6.6.2"
                        },
                        {
                            "ecmp-group-id": "200100",
                            "ecmp-members": [["100001", "3.3.3.1", "31"], ["100002", "7.7.7.2", "21"]],
                            "ecmp-dst-member": "100001",
                            "ecmp-dst-port": "31",
                            "ecmp-next-hop-ip": "3.3.3.2"
                        }
                    ]
                                    }
            ]
        }
    ],
    "id": 1
}</pre><pre></pre><h1><a class="anchor" id="PT_DROP_REASON"></a>
configure-packet-trace-drop-reason</h1>
<p>The packets can be dropped due to multiple reasons. The agent can be configured to send the dropped packets for a specific drop-reason. The various supported drop reasons are listed below</p>
<pre></pre><pre>DROP REASON                      DESCRIPTION
---------------------------------------------------------------------
---------------------------------------------------------------------</pre><pre>vlan-xlate-miss-drop               VLAN translation miss drop
---------------------------------------------------------------------
bpdu-drop                          BPDU drop
---------------------------------------------------------------------
protocol-pkt-drop                  Protocol packet drop 
---------------------------------------------------------------------
cml-drop                           CML (CPU managed learning) drop
---------------------------------------------------------------------
src-route-drop                     Source route drop
---------------------------------------------------------------------
l2-src-discard-drop                L2 source discard drop
---------------------------------------------------------------------
l2src-static-move-drop             L2 source static move drop
---------------------------------------------------------------------
l2dst-discard-drop                 L2 destination discard drop
---------------------------------------------------------------------
cfi-or-l3disable-drop              CFI or L3 Disable drop
---------------------------------------------------------------------
higig-mh-type1-drop                HiGig module header type 1 drop
---------------------------------------------------------------------
disc-stage-drop                    HiGig discard drop
---------------------------------------------------------------------
sw1-invalid-vlan-drop              HiGig invalid VLAN drop 
---------------------------------------------------------------------
higig-hdr-error-drop               HiGig header error drop
---------------------------------------------------------------------
lag-failover-drop                  Looped back packet drop
---------------------------------------------------------------------
macsa0-drop                        MAC SA all zero drop
---------------------------------------------------------------------
vfp-drop                           VFP (VLAN field processor ) 
                                   drop condition 
---------------------------------------------------------------------
vlan-cc-or-pbt-drop                VLAN cross connect drop 
---------------------------------------------------------------------
class-based-sm-drop                Class based learning drop
---------------------------------------------------------------------
mpls-stage-drop                    MPLS state drop
---------------------------------------------------------------------
time-sync-pkt-drop                 Time sync drop
---------------------------------------------------------------------
my-station-drop                    My station drop
---------------------------------------------------------------------
bad-udp-checksum-drop              Bad UDP checksum drop
---------------------------------------------------------------------
niv-forwarding-drop                NIV (Network Interface 
                                   Virtualization) forwarding drop 
---------------------------------------------------------------------
niv-rpf-check-fail-drop            NIV (Network Interface 
                                   Virtualization)Reverse path 
                                    forwarding (RPF)check fail drop
---------------------------------------------------------------------
pvlan-vp-efilter-drop              Private VLAN VP filter drop 
---------------------------------------------------------------------
trill-header-version-nonzero-drop  Trill header non zero drop
---------------------------------------------------------------------
trill-adjacency-check-fail-drop    Trill adjacency check fail drop 
---------------------------------------------------------------------
trill-rbridge-lookup-miss-drop     Trill RBridge Lookup miss drop
---------------------------------------------------------------------
trill-uc-hdr-mc-macda-drop         Trill UC header MC MAC SA drop
---------------------------------------------------------------------
trill-slowpath-drop                Trill slow path drop 
---------------------------------------------------------------------
core-is-is-pkt-drop                Core IS-IS packet drop
---------------------------------------------------------------------
trill-rpf-check-fail-drop          Trill RPF Check fail drop
---------------------------------------------------------------------
trill-pkt-with-snap-encap-drop     Trill packet SNAP encapsulation 
                                   drop 
---------------------------------------------------------------------
trill-ing-rbridge-eq-              Trill packet with Ingress RBridge 
---------------------------------------------------------------------
egr-rbridge-drop                    equal to egress RBridge drop
---------------------------------------------------------------------
trill-hopcount-check-fail-drop     Trill hop count check fail drop 
---------------------------------------------------------------------
bfd-terminated-drop                BRD terminated drop  
---------------------------------------------------------------------
l3dst-discard-drop                 L3 destination discard drop
---------------------------------------------------------------------
tunnel-decap-ecn-drop              Tunnel decap ECN error drop  
---------------------------------------------------------------------
l3-pkt-resource-drop               L3 packet discarded due to 
                                   resource
---------------------------------------------------------------------
Ipv4-header-error-drop             IPv4 Header Error Packets
---------------------------------------------------------------------
l3-ipv6-pkt-resource-drop          L3 packet discarded due to 
                                   resource
---------------------------------------------------------------------
Ipv6-header-error-drop             IPv6 Header Error Packets
---------------------------------------------------------------------
Ingress-port-fwd-state-drop        Ingress port not in forwarding 
                                   state drop
---------------------------------------------------------------------
field-processor-drop               FP Drop
---------------------------------------------------------------------
multicast-drop                     Multicast drop
---------------------------------------------------------------------
bitmap-zero-drop                   All bitmaps are zero drop
---------------------------------------------------------------------
policy-drop                        Policy discard such as discard 
                                   tag/untag pkts, 
                                   disc. Based on SA/DA lookup
---------------------------------------------------------------------
dos-l4-header-error-drop           DOS L4 header error packets, 
                                   applicable only to 10GE ingress 
                                   ports
---------------------------------------------------------------------
mtu-error-drop                     MTU Error drop
---------------------------------------------------------------------
recv-tunneled-pkt-error-drop       Received Tunneled Packets with 
                                   Errors
---------------------------------------------------------------------
vlan-error-drop                    VLAN related Errors
---------------------------------------------------------------------
higig-header-error-drop            HiGig Header errors
---------------------------------------------------------------------
mc-ipmc-index-error-drop           MC/IPMC index error
---------------------------------------------------------------------
parity-error-drop                  parity error
---------------------------------------------------------------------
reverse-rpf-error-drop             Reverse RPF check failed drop
---------------------------------------------------------------------
dst-discard-bit-error-drop         L2/L3 lookup DST_DISCARD bit
---------------------------------------------------------------------
ecmp-calculation-error-drop        ECMP calculation want resolve
---------------------------------------------------------------------
mpls-seq-num-error-drop            MPLS sequence number check fail 
---------------------------------------------------------------------
field-processor-redirect           This error will cover the Rsel2
---------------------------------------------------------------------
-error-drop                        wrong FP redirect and Sw2 FP FWD 
                                   vector  zero 
---------------------------------------------------------------------
invalid-l2mc-entry-drop            Invalid L2 MC entry drop
---------------------------------------------------------------------</pre><pre></pre><h1><a class="anchor" id="PT_ERRORS"></a>
Reporting Errors</h1>
<p>The agent uses the standard HTTP error reporting mechanism for reporting any errors. The error codes are listed below.</p>
<div class="image">
<img src="../../pt_errors.jpg" alt="pt_errors.jpg"/>
</div>
<p> Each of the error listed above (HTTP error codes 4xx &amp; 5xx) have JSONRPC payload in the response packet to give additional error details in the following format.</p>
<pre></pre><pre>Example of HTTP 404 error:</pre><pre>HTTP/1.1 404 Not Found
Server: BroadViewAgent (Unix) (Linux) 
Content-Type: text/json</pre><pre>{
       "jsonrpc": "2.0", 
       "version": "1", 
       "error": {
              "code": -32601, 
              "message": "Method not found"
       }, 
       "id": 1
}</pre><pre></pre><h1><a class="anchor" id="PT_CONFIG_CMDS"></a>
Configuration Commands</h1>
<p>This section describes various configuration commands supported by the Packet Trace feature. The name of the command becomes the method in the JSON-RPC message and any associated parameters for the command form the params in the JSON-RPC message.</p>
<h2><a class="anchor" id="PT_FEATURE"></a>
configure-packet-trace-feature</h2>
<p>The configure-packet-trace-feature command setups the Packet Trace functionality on the Agent. The parameters associated with this commands are described below.</p>
<div class="image">
<img src="../../pt_config_feature.jpg" alt="pt_config_feature.jpg"/>
</div>
<p> The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/configure-packet-trace-feature</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": "configure-packet-trace-feature",
    "asic-id": "1",    
    "params": {
        "packet-trace-enable": 1
     },
    "id": 1
}</pre><pre></pre><p>The Agent acknowledges the command, and may return appropriate error code if needed.</p>
<h2><a class="anchor" id="PT_DROP_REASON"></a>
configure-packet-trace-drop-reason</h2>
<p>The configure-packet-trace-drop-reason command configures agent to send a copy of dropped packets and/or trace-profile to requestor asynchronously. The parameters associated with this command are described below.</p>
<div class="image">
<img src="../../pt_drop_reason.jpg" alt="pt_drop_reason.jpg"/>
</div>
<p> The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/configure-packet-trace-drop-reason</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": "configure-packet-trace-drop-reason",
    "asic-id": "1",
    "params": {
               "reason" : ["vlan-xlate-miss-drop", "bpdu-drop", "trill-slowpath-drop" ],
               "port-list" : ["1","5","6","10-15"], 
               "send-dropped-packet" : 1,
               "trace-profile" : 0,
               "packet-count": 3, 
               "packet-threshold": 0}, 
    "id": 1
}</pre><pre></pre><p>The Agent acknowledges the command, and may return appropriate error code if needed.</p>
<h1><a class="anchor" id="PT_CANCEL"></a>
Cancel Commands</h1>
<p>This section describes various cancel commands supported by the Packet Trace feature. The name of the command becomes the method in the JSON-RPC message and any associated parameters for the command form the params in the JSON-RPC message.</p>
<h2><a class="anchor" id="PT_CANCEL_TP"></a>
cancel-packet-trace-profile</h2>
<p>The cancel-packet-trace-profile command is used to cancel the trace-profile request that already made by the Collector through the command get-packet-trace-profile command.</p>
<div class="image">
<img src="../../pt_cancel.jpg" alt="pt_cancel.jpg"/>
</div>
<p> The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/cancel-packet-trace-profile</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{ 
    "jsonrpc": "2.0", 
    "method": "cancel-packet-trace-profile", 
    "asic-id": "1", 
    "params": { 
        "id" : 2</pre><pre>    }, 
    "id": 1 
}</pre><pre></pre><p>The Agent acknowledges the command, and may return appropriate error code if needed</p>
<h2><a class="anchor" id="PT_CANCEL_LAG"></a>
cancel-packet-trace-lag-resolution</h2>
<p>The cancel-packet-trace-lag-resolution command is used to cancel the lag-resolution request that already made by the Collector through the command get-packet-trace-lag-resolution command.</p>
<div class="image">
<img src="../../pt_cancel_lag.jpg" alt="pt_cancel_lag.jpg"/>
</div>
<p> The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/cancel-packet-trace-lag-resolution</p>
<pre></pre><pre>A sample JSON-RPC request is shown below.
{ 
    "jsonrpc": "2.0", 
    "method": "cancel-packet-trace-lag-resolution", 
    "asic-id": "1",
    "params": { 
        "id" : 2</pre><pre>    }, 
    "id": 1 
}</pre><pre></pre><p>The Agent acknowledges the command, and may return appropriate error code.</p>
<h2><a class="anchor" id="PT_CANCEL_ECMP"></a>
cancel-packet-trace-ecmp-resolution</h2>
<p>The cancel-packet-trace-ecmp-resolution command is used to cancel the ecmp-resolution request that already made by the Collector through the command get-packet-trace-ecmp-resolution command.</p>
<div class="image">
<img src="../../pt_cancel_ecmp.jpg" alt="pt_cancel_ecmp.jpg"/>
</div>
<p> The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/cancel-packet-trace-ecmp-resolution</p>
<pre></pre><pre>A sample JSON-RPC request is shown below.
{ 
    "jsonrpc": "2.0", 
    "method": "cancel-packet-trace-ecmp-resolution", 
    "asic-id": "1",
    "params": { 
        "id" : 2</pre><pre>    }, 
    "id": 1 
}
</pre><p>The Agent acknowledges the command, and may return appropriate error code.</p>
<h2><a class="anchor" id="PT_DROP_PACKET"></a>
cancel-packet-trace-send-drop-packet</h2>
<p>The cancel-packet-trace-send-drop-packet command is used to cancel the send-dropped-packet request for a given list of ports. This command allows canceling of send-dropped-packet request for multiple drop reasons at a time.</p>
<div class="image">
<img src="../../pt_drop_packet.jpg" alt="pt_drop_packet.jpg"/>
</div>
<p> The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/cancel-packet-trace-send-drop-packet</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{ 
    "jsonrpc": "2.0", 
    "method": "cancel-packet-trace-send-drop-packet", 
    "asic-id": "1", 
    "params":   {"drop-reason" : [ {"l2-lookup-failure" }, {"l3-failure"}, {"vlan-mismatch"} ],
                 "port-list" : ["1", "11", "3", "4-10"]
                }, 
    "id": 1 
}</pre><pre></pre><p>The Agent acknowledges the command, and may return appropriate error code if needed.</p>
<h2><a class="anchor" id="PT_CANCEL_DROP_COUNTER"></a>
cancel-drop-counter-report</h2>
<p>The cancel-packet-trace-drop-counter-report command is used to cancel the drop-counter-report request for a given list of ports. This command allows canceling of send-dropped-packet request for multiple drop reasons at a time.</p>
<div class="image">
<img src="../../pt_cancel_drop_counter.jpg" alt="pt_cancel_drop_counter.jpg"/>
</div>
<p> The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/cancel-packet-trace-drop-counter-report</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{ 
    "jsonrpc": "2.0", 
    "method": "cancel-packet-trace-drop-counter-report", 
    "asic-id": "1", 
    "params":   {"drop-reason" : [ "l2-lookup-failure" , "l3-failure", "vlan-mismatch" ],
                 "port-list" : ["1", "11", "3", "4-10"]
                }, 
    "id": 1 
}</pre><pre></pre><p>The Agent acknowledges the command, and may return appropriate error code if needed</p>
<h1><a class="anchor" id="PT_STATUS_REPORT"></a>
Status / Reporting Commands</h1>
<h2><a class="anchor" id="PT_GET_PT_FEATURE"></a>
get-packet-trace-feature</h2>
<p>The get-packet-trace-feature command is used to retrieve the current configuration of the Packet Trace functionality on the Agent . The parameters associated with this commands are described below.</p>
<div class="image">
<img src="../../pt_get_pt_feature.jpg" alt="pt_get_pt_feature.jpg"/>
</div>
<p> For the response, the agent returns the same parameters as that of the configure-packet-trace-feature command. The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/get-packet-trace-feature</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-feature",
    "asic-id": "1",
    "params": { },
    "id": 1
}</pre><pre></pre><p>An associated sample response is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-feature",
    "asic-id": "1",
    "version": "1",
    "result": {
        "packet-trace-enable": 1,
    },
    "id": 1
}</pre><pre></pre><p>The Agent may return appropriate error code if needed.</p>
<h2><a class="anchor" id="PT_LAG_RES"></a>
get-packet-trace-lag-resolution</h2>
<p>The get-packet-trace-lag-resolution command is used to retrieve the LAG resolution for the given packet. The parameters associated with this commands are described below.</p>
<div class="image">
<img src="../../pt_lag_resolution.jpg" alt="pt_lag_resolution.jpg"/>
</div>
<p> Note that this command is valid even when the feature is disabled on the agent.</p>
<p>The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/get-packet-trace-lag-resolution</p>
<pre></pre><pre>A sample JSON-RPC request is shown below.
{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-lag-resolution",
    "asic-id": "1",
    "params": {
        "packet": "000001000002..",
        "port-list": ["1","2","3","4-10"],
        "collection-interval": 10,
        "drop-packet": 1
    },
    "id": 1
}</pre><pre></pre><p>An associated sample response is shown below. The response is asynchronous if the collection interval is non-zero. An associated sample response is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": " get-packet-trace-lag-resolution",
    "asic-id": "1",
    "version": "1",
    "time-stamp": "2014-11-18 - 00:15:04 ",
    "report": [
        {
            "port": "1",
            "lag-link-resolution": {
                "lag-id": "2",
                "lag-members": [
                    "1",
                    "2",
                    "3",
                    "4"
                ],
                "dst-lag-member": "4"
            }
        },
        {
            "port": "2",
            "lag-link-resolution": {
                "lag-id": "2",
                "lag-members": [
                    "1",
                    "2",
                    "3",
                    "4"
                ],
                "dst-lag-member": "4"
            }
        }
    ],
    "id": 1
}</pre><pre></pre><h2><a class="anchor" id="PT_TRACE_ECMP"></a>
get-packet-trace-ecmp-resolution</h2>
<p>The get-packet-trace-ecmp-resolution command is used to retrieve the ECMP link resolution for the given packet. The parameters associated with this commands are described below.</p>
<div class="image">
<img src="../../pt_lag_resolution.jpg" alt="pt_lag_resolution.jpg"/>
</div>
<p> Note that this command is valid even when the feature is disabled on the agent.</p>
<p>The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/get-packet-trace-ecmp-resolution</p>
<pre></pre><pre>A sample JSON-RPC request is shown below.
{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-ecmp-resolution",
    "asic-id": "1",
    "params": {
        "packet": "000001000002..",
        "port-list": ["1","2","3","4-10"],
        "collection-interval": 10,
        "drop-packet": 1
    },
    "id": 1
}</pre><pre></pre><p>An associated sample response is shown below. The response is asynchronous if the collection interval is non-zero. An associated sample response is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": " get-packet-trace-ecmp-resolution",
    "asic-id": "1",
    "version": "1",
    "time-stamp": "2014-11-18 - 00:15:04 ",
    "report": [
        {
            "port": "1",
            "ecmp-link-resolution": [
                {
                    "ecmp-group-id": "200256",
                    "ecmp-members": [["100004", "2.2.2.2", "28"],["100005", "6.6.6.1", "41"]],
                    "ecmp-dst-member": "100005",
                    "ecmp-dst-port": "41",
                    "ecmp-next-hop-ip": "6.6.6.2"
                },
                {
                    "ecmp-group-id": "200100",
                    "ecmp-members": [["100001", "3.3.3.1", "31"], ["100002", "7.7.7.2", "21"]],
                    "ecmp-dst-member": "100001",
                    "ecmp-dst-port": "31",
                    "ecmp-next-hop-ip": "3.3.3.2"
                }
            ]
        },
        {
            "port": "2",
            "ecmp-link-resolution": [
                {
                    "ecmp-group-id": "200256",
                    "ecmp-members": [
                        "100004",
                        "100005"
                    ],
                    "ecmp-dst-member": "100005",
                    "ecmp-dst-port": "41",
                    "ecmp-next-hop-ip": "6.6.6.2"
                },
                {
                    "ecmp-group-id": "200100",
                    "ecmp-members": [
                        "100001",
                        "100002"
                    ],
                    "ecmp-dst-member": "100001",
                    "ecmp-dst-port": "31",
                    "ecmp-next-hop-ip": "3.3.3.2"
                }
            ]
        }
    ],
    "id": 1
}</pre><pre></pre><h2><a class="anchor" id="PT_TRACE_PROFILE"></a>
get-packet-trace-profile</h2>
<p>The get-packet-trace-profile command is used to retrieve the trace-profile for the given packet. The parameters associated with this commands are described below.</p>
<div class="image">
<img src="../../pt_trace_table.jpg" alt="pt_trace_table.jpg"/>
</div>
<p> Note that this command is valid even when the feature is disabled on the agent.</p>
<p>The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/get-packet-trace-profile</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-profile",
    "asic-id": "1",
    "params": { 
            "packet" : "000001000002..",
            "port-list" : ["1","2","3","4-10"],
            "collection-interval" : 10,
            "drop-packet" : 1},
    "id": 1
}
</pre><p>An associated sample response is shown below. The response is asynchronous if the collection interval is non-zero. An associated sample response is shown below.</p>
<pre>
{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-profile",
    "asic-id": "1",
    "version": "1",
    "time-stamp": "2014-11-18 - 00:15:04 ",
    "report": [
        {
            "port": "1",
            "trace-profile": [
                {
                    "realm": "lag-link-resolution",
                    "data": {
                        "lag-id": "2",
                        "lag-members": ["1", "2", "3", "4"],
                        "dst-lag-member": "4"
                    }
                },
                {
                    "realm": "ecmp-link-resolution",
                    "data": 
                       [
                        {
                            "ecmp-group-id": "200256",
                            "ecmp-members": [["100004", "2.2.2.2", "28"],["100005", "6.6.6.1", "41"]],
                            "ecmp-dst-member": "100005",
                            "ecmp-dst-port": "41",
                            "ecmp-next-hop-ip": "6.6.6.2"
                        },
                        {
                            "ecmp-group-id": "200100",
                            "ecmp-members": [["100001", "3.3.3.1", "31"], ["100002", "7.7.7.2", "21"]],
                            "ecmp-dst-member": "100001",
                            "ecmp-dst-port": "31",
                            "ecmp-next-hop-ip": "3.3.3.2"
                        }
                    ]
                }
            ]
        },
        {
            "port": "2",
            "trace-proifle": [
                {
                    "realm": "lag-link-resolution",
                    "data": {
                        "lag-id": "2",
                        "lag-members": ["1", "2", "3", "4"],
                        "dst-lag-member": "4"
                    }
                },
                {
                    "realm": "ecmp-link-resolution",
                    "data": 
                            [
                        {
                            "ecmp-group-id": "200256",
                            "ecmp-members": [["100004", "2.2.2.2", "28"],["100005", "6.6.6.1", "41"]],
                            "ecmp-dst-member": "100005",
                            "ecmp-dst-port": "41",
                            "ecmp-next-hop-ip": "6.6.6.2"
                        },
                        {
                            "ecmp-group-id": "200100",
                            "ecmp-members": [["100001", "3.3.3.1", "31"], ["100002", "7.7.7.2", "21"]],
                            "ecmp-dst-member": "100001",
                            "ecmp-dst-port": "31",
                            "ecmp-next-hop-ip": "3.3.3.2"
                        }
                    ]
                }
            ]
        }
    ],
    "id": 1
}</pre><pre></pre><p>The Agent may return appropriate error code if needed</p>
<h2><a class="anchor" id="PT_GET_DROP_REASON"></a>
get-packet-trace-drop-reason</h2>
<p>The get-packet-trace-drop-reason command is used to retrieve the current configured drop reasons on the Broadcom ASIC. The parameters associated with this commands are described below.</p>
<div class="image">
<img src="../../pt_get_drop_reason.jpg" alt="pt_get_drop_reason.jpg"/>
</div>
<p> For the response, the agent returns the same parameters as that of the configure-packet-trace-drop-reason command. Note that this command is valid even when the feature is disabled on the agent.</p>
<p>The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/get-packet-trace-drop-reason</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-drop-reason",
    "asic-id": "1",
    "params": { },
    "id": 1
}
</pre><p>An associated sample response is shown below</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-drop-reason",
    "asic-id": "1",
    "version": "1",
    "result": [
        {
            "reason": "l2-lookup-failure",
            "port-list": [
                "1",
                "5",
                "6",
                "10-15"
            ],
            "send-dropped-packet": 1,
            "trace-profile": 0,
            "packet-count": 3,
            "packet-threshold": 0
        },
        {
            "reason": "vlan-mismatch",
            "port-list": [
                "1",
                "5",
                "6",
                "10-15"
            ],
            "send-dropped-packet": 1,
            "trace-profile": 1,
            "packet-count": 3,
            "packet-threshold": 10
        }
    ],
    "id": 1
}</pre><pre></pre><p>The Agent may return appropriate error code if required</p>
<h2><a class="anchor" id="PT_GET_DROP_REPORT"></a>
get-packet-trace-drop-counter-report</h2>
<p>The get-packet-trace-drop-counter-report command is used to retrieve the drop counter-report. The parameters associated with this commands are described below.</p>
<div class="image">
<img src="../../pt_get_drop_report.jpg" alt="pt_get_drop_report.jpg"/>
</div>
<p> Note that this command is valid even when the feature is disabled on the agent.</p>
<p>The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/get-packet-trace-drop-counter-report</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": " get-packet-trace-drop-counter-report",
    "asic-id": "1",
    "params": { 
               "drop-reason" : [ "vlan-xlate-miss-drop" , "bpdu-drop", "trill-slowpath-drop"],
               "port-list" : ["1","5","6","10-12"]
              },
    "id": 1
}</pre><pre></pre><p>The method object of the JSON message in the report is set to get-packet-trace-drop-counter-report, for the response message.</p>
<p>A sample drop counter report indicating various realms (drop reasons) and the associated data is shown below.</p>
<p>An associated sample response is shown below</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": " get-packet-trace-drop-counter-report",
    "asic-id": "1",
    "version": "1",
    "report": [
        {
            "realm": "vlan-xlate-miss-drop",
            "data": [
                {
                    "port": "1",
                    "count": 10
                },
                {
                    "port": "5",
                    "count": 20
                },
                {
                    "port": "6",
                    "count": 30
                },
                {
                    "port": "10",
                    "count": 40
                },
                {
                    "port": "11",
                    "count": 50
                },
                {
                    "port": "12",
                    "count": 60
                }
            ]
        },
        {
            "realm": "bpdu-drop",
            "data": [
                {
                    "port": "1",
                    "count": 70
                },
                {
                    "port": "5",
                    "count": 20
                },
                {
                    "port": "6",
                    "count": 30
                },
                {
                    "port": "10",
                    "count": 40
                },
                {
                    "port": "11",
                    "count": 80
                },
                {
                    "port": "12",
                    "count": 90
                }
            ]
        },
        {
            "realm": "trill-slowpath-drop",
            "data": [
                {
                    "port": "1",
                    "count": 10
                },
                {
                    "port": "5",
                    "count": 20
                },
                {
                    "port": "6",
                    "count": 30
                },
                {
                    "port": "10",
                    "count": 40
                },
                {
                    "port": "11",
                    "count": 50
                },
                {
                    "port": "12",
                    "count": 60
                }
            ]
        }
    ]
}</pre><pre></pre><p>The Agent may return appropriate error code if needed</p>
<h2><a class="anchor" id="PT_SUPPORTED_DROP_REASONS"></a>
get-packet-trace-supported-drop-reasons</h2>
<p>The get-packet-trace-supported-drop-reasons command is used to retrieve the supported drop reasons on the Broadcom ASIC. The parameters associated with this commands are described below.</p>
<div class="image">
<img src="../../pt_get_pt_supported_drop_reasons.jpg" alt="pt_get_pt_supported_drop_reasons.jpg"/>
</div>
<p> Note that this command is valid even when the feature is disabled on the agent.</p>
<p>The associated REST URL for this command is as follows:</p>
<p><a href="http://">http://</a>&lt;ipaddr&gt;:8080/broadview/packettrace/get-packet-trace-supported-drop-reasons</p>
<p>A sample JSON-RPC request is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": " get-packet-trace-supported-drop-reasons",
    "asic-id": "1",
    "params": { },
    "id": 1
}
</pre><p>An associated sample response is shown below.</p>
<pre></pre><pre>{
    "jsonrpc": "2.0",
    "method": "get-packet-trace-drop-reasons",
    "asic-id": "1",
    "version": "1",
    "result": [
        "l2-lookup-failure",
        "vlan-mismatch"
    ],
    "id": 1
}
</pre><p>The Agent may return appropriate error code if needed </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 30 2015 18:57:39 for BroadView&trade; API Guide and Reference Manual by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
